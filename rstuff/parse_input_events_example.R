## set pwd to ~/path/to/squiggler/example_dtw/ 
setwd("~/searchPaths/bitbucket/squiggler/example_dtw/") 
source("~/searchPaths/bitbucket/squiggler/example_dtw/hmm_functions.R")
source("~/searchPaths/bitbucket/squiggler/example_dtw/parse_input_events_functions.R")

## Rules:
## 1. Template events always start ar position 51 (i.e. 1st 50 events are burned off -- many of which are adapter)
## 2. Complement events always end with 10 events left (i.e. last 10 events are burned off)
## 3. When True end of template events is mapped and beginning of comp events, HP is always 61 events long
## 4. Max event is always inside HP coordinates

## sciara 1: Temp start pos 51, HP size = 71 events, 10 input events after complement end
template <- read.events.file("../data/events/sciara_ch111_file162_template.tsv", input.events = FALSE)
complement <- read.events.file("../data/events/sciara_ch111_file162_complement.tsv", input.events = FALSE)
input <- read.events.file("../data/events/sciara_ch111_file162_input.tsv", input.events = TRUE)
find_position_in_input(subset=template$mean, input=input$mean, window=50) # 51, 3473, FALSE
end.template <- template$mean[(length(template$mean)-20):length(template$mean)] ## 
## get actual end of template in input
find_position_in_input(subset=end.template, input=input$mean, window=10) # 3463, 3483, TRUE
# template = 51 - 3483 -- with 10 events erased from input (probably 10 0 moves)
find_position_in_input(subset=complement$mean, input=input$mean, window=50) # 3544, 6260, FALSE
end.comp <- complement$mean[(length(complement$mean)-20):length(complement$mean)] 
find_position_in_input(subset=end.comp, input=input$mean, window=5) # starts at 6247 and ends on 6267 in input
3544 - 3483 ## 61 events for hairpin
3543 - 3484 + 1 ## or is it 60 events?
which.max(input$mean) %in% 3483:3544 ## TRUE
which.max(input$mean[3483:3544]) ## 34
which.max(input$mean[3484:3543]) ## 33
order(input$mean[3483:3544])
max_window_index(vec = input$mean[3483:3544], winsize = 60) ## 3
max_window_index(vec = input$mean, winsize = 60)
max_window_index(vec = input$mean, winsize = 3)
input.size <- length(input$mean) ## 6277
input.size - 6267 ## 10 events at end cut off
plot(1:length(input$mean[3544:6260]), input$mean[3544:6260], type="l")

## sciara 2: Temp start pos 51, HP size = 82 events, 10 input events after complement end
template <- read.events.file("../data/events/sciara_ch224_file20_template.tsv", input.events = FALSE)
complement <- read.events.file("../data/events/sciara_ch224_file20_complement.tsv", input.events = FALSE)
input <- read.events.file("../data/events/sciara_ch224_file20_input.tsv", input.events = TRUE)
find_position_in_input(subset=template$mean, input=input$mean, window=50) # 51, 5866, FALSE
end.template <- template$mean[(length(template$mean)-20):length(template$mean)] ## 
## get actual end of template in input
find_position_in_input(subset=end.template, input=input$mean, window=10) # 5867, 5887, TRUE
# template = 51 - 5887 -- with 21 events erased from input (probably 21 0 moves)
find_position_in_input(subset=complement$mean, input=input$mean, window=50) # 5948, 13329, FALSE
end.comp <- complement$mean[(length(complement$mean)-20):length(complement$mean)] 
find_position_in_input(subset=end.comp, input=input$mean, window=5) # starts at 13320 and ends on 13340 in input
5948 - 5887 ## 61 events for hairpin
5947 - 5888 + 1 ## or 60 
which.max(input$mean) %in% 5887:5948 ## TRUE
which.max(input$mean[5887:5948]) ## position 37
which.max(input$mean[5888:5947]) ## or.. position 36
order(input$mean[5887:5948], decreasing = TRUE)
max_window_index(vec = input$mean[5887:5948], winsize = 60) ## 3
max_window_index(vec = input$mean, winsize = 60) ## doesnt agree
max_window_index(vec = input$mean, winsize = 10) ##does agree
max_window_index(vec = input$mean, winsize = 3) ##does agree
input.size <- length(input$mean) ## 13350
input.size - 13340 ## 10 events at end cut off
plot(1:length(input$mean[5886:5948]), input$mean[5886:5948], type="l")
plot(input$mean, type="l")

## lambda 1: 
template <- read.events.file("../data/events/lambda_ch230_file5_template.tsv", input.events = FALSE)
complement <- read.events.file("../data/events/lambda_ch230_file5_complement.tsv", input.events = FALSE)
input <- read.events.file("../data/events/lambda_ch230_file5_input.tsv", input.events = TRUE)
find_position_in_input(subset=template$mean, input=input$mean, window=50) # 51, 32841, FALSE
end.template <- template$mean[(length(template$mean)-20):length(template$mean)] ## 
## get actual end of template in input
find_position_in_input(subset=end.template, input=input$mean, window=10) # 33137, 33157, TRUE
# template = 51 - 33157 -- with 316 events erased from input (probably 316 0 moves)
find_position_in_input(subset=complement$mean, input=input$mean, window=43) # 33218, 62533, FALSE
end.comp <- complement$mean[(length(complement$mean)-20):length(complement$mean)] 
find_position_in_input(subset=end.comp, input=input$mean, window=5) # starts at 62847 and ends on 62867 in input
33218 - 33157 ## 61 events for hairpin
33217 - 33158 + 1 ## 60...
which.max(input$mean) %in% 33157:33218  ##TRUE
which.max(input$mean[33157:33218])
which.max(input$mean[33158:33217])
order(input$mean[33157:33218])
max_window_index(vec = input$mean[33157:33218], winsize = 60) ## 2
max_window_index(vec = input$mean, winsize = 60)
max_window_index(vec = input$mean, winsize = 10) 
max_window_index(vec = input$mean, winsize = 200)
input.size <- length(input$mean) ## 62877
input.size - 62867 ## 10 events at end cut off
plot(1:length(input$mean[33157:33218]), input$mean[33157:33218], type="l")
plot(1:length(input$mean), input$mean, type="l")
plot(1:length(input$mean[48834:(48834+60-1)]), input$mean[48834:(48834+60-1)], type="l")





###
template <- read.events.file("../data/events/sciara_ch111_file162_template.tsv", input.events = FALSE)
complement <- read.events.file("../data/events/sciara_ch111_file162_complement.tsv", input.events = FALSE)
input <- read.events.file("../data/events/sciara_ch111_file162_input.tsv", input.events = TRUE)
a<-max_window_index(vec = input$mean, winsize = 3)
which.max(input$mean[a$max.index:(a$max.index+3-1)])
plot(input$mean[(a$max.index+1-30):(a$max.index+1+30)], type="l")
template <- read.events.file("../data/events/sciara_ch224_file20_template.tsv", input.events = FALSE)
complement <- read.events.file("../data/events/sciara_ch224_file20_complement.tsv", input.events = FALSE)
input <- read.events.file("../data/events/sciara_ch224_file20_input.tsv", input.events = TRUE)
a<-max_window_index(vec = input$mean, winsize = 3)
which.max(input$mean[a$max.index:(a$max.index+3-1)])
lines(input$mean[(a$max.index+1-30):(a$max.index+1+30)], col="blue")
max_window_index(vec = input$mean, winsize = 3)
template <- read.events.file("../data/events/lambda_ch230_file5_template.tsv", input.events = FALSE)
complement <- read.events.file("../data/events/lambda_ch230_file5_complement.tsv", input.events = FALSE)
input <- read.events.file("../data/events/lambda_ch230_file5_input.tsv", input.events = TRUE)
max_window_index(vec = input$mean, winsize = 3)
a<-max_window_index(vec = input$mean, winsize = 3)
which.max(input$mean[a$max.index:(a$max.index+3-1)])
lines(input$mean[(a$max.index+1-30):(a$max.index+1+30)], col="red")



#### MArch 6, 2015
### working on profile HMM to identify leader
### take a bunch of lead adapter seqs
### learn some decent means and stdevs
### transition only from si==>si+1
##from lambda pass reads -- leaders 12-22 events long
l1=c(49.445373849307792, 69.060074715102004, 82.608054251163566, 89.996370771215595, 100.17752854410806, 103.43851367147833, 98.76813487510509, 72.604481087618097, 43.153485542831909, 47.228136474609371, 48.747833161157025, 43.325699478952508)
l2=c(52.590971361243206, 51.937694742838538, 73.392483656799897, 87.756848339843742, 96.346493571888317, 101.8026884909237, 107.20973825713733, 110.81886901855468, 111.24157719343368, 106.25096137152778, 101.06739334106445, 81.044985033369741, 48.052823460355725, 50.681234148052376, 52.817278446320564, 47.158087209271677)
l3=c(51.584104959239127, 52.13919292249178, 52.499807883522728, 76.432855834960932, 87.879115717961241, 95.215595486688272, 100.56907764499471, 106.06765684964363, 109.42897156362064, 104.25301991429822, 78.039875634765622, 48.457507921006943, 50.381694889658505, 52.298518187342786, 46.729587817548897)
l4=c(44.32246242357337, 50.019110064839211, 69.939347599362861, 83.742807617187495, 87.73612984793526, 91.726116800436358, 96.841143002219027, 102.70080517301479, 100.63172021484374, 102.42528293839419, 105.99176826056532, 106.84893863351004, 104.66104502129878, 101.28098656631096, 102.48080788889239, 103.95732982622017, 101.46996821138048, 76.340219985826877, 45.012594517299107, 48.152248815777661, 50.353871856689459, 44.561854633318625)
l5=c(42.968871236165363, 49.09418786390772, 68.375718237506447, 81.277307080078131, 89.518263640749495, 94.908804087697717, 100.42387791367828, 104.05472696940103, 104.55548761157701, 102.92304807330491, 101.68035954173017, 98.866351941167082, 76.357667759486603, 45.206101812318316, 47.256302166374361, 49.293395973276866, 44.080633680555557)
l6=c(40.70830925835503, 44.507823110021143, 63.710984799283224, 79.024743223248095, 86.133974066840267, 85.245070214586079, 90.138806570870528, 95.547263239879769, 98.856635655966826, 100.117099609375, 99.461512354800576, 98.287337456597214, 97.651616860741441, 97.304970735108483, 96.680111521753773, 82.959180786132819, 98.433903755519694, 42.926473515828448, 97.620469923753006, 41.812130353418411, 39.873726303145858, 38.546448883952664)
l7=c(74.921157806396479, 88.512145046657977, 96.074988671874991, 101.32896631447665, 106.20833623046873, 109.89985697996681, 111.28496164270996, 109.49638957551836, 88.102709460890424, 53.067910754394532, 56.1603376412899, 50.391929652897389, 48.857286849576901, 51.854613359823993)
##from sciara run 002,006,008 pass reads --basecaller XL
s1=c(42.79119723233309, 46.798845214843745, 62.347552185058589, 76.659472270764795, 83.249503417968754, 88.004326818129584, 92.93899471768465, 96.431869883080054, 96.073025360107422, 93.661611557006836, 70.625439943188297, 46.474195919552365, 48.72268246270913, 44.475487296811984, 42.142153834292756)
s2=c(65.642363141169298, 78.760438476562499, 87.820906073099579, 92.601106651569225, 97.782098764272831, 97.97407114664712, 101.34372985839843, 99.065755913085923, 48.9732700700431, 46.251836125300478, 45.112191372575431, 47.380227172851562, 56.725924987792965)
s3=c(50.40245239257812, 65.941206542968743, 83.949632812499999, 88.937025146484373, 94.167403564453124, 97.884266967773442, 101.57182631272536, 101.16898753851233, 101.03036123422476, 99.138450965881347, 65.821523104580962, 44.849465332031244, 49.124373046874993, 51.42019841974431, 47.000046615600581)
s4=c(62.303596097506002, 49.696831787109375, 68.814025065104161, 84.52003234863281, 89.497586263020835, 92.737882401315787, 99.041539672851556, 108.18452701344209, 109.75043060302735, 108.6797787661345, 106.59712971548016, 103.33223461914062, 82.018099365234377, 46.982028579711908, 48.616388697130922, 51.25940431123621, 44.404677246093748)
s5=c(44.924286295572912, 50.135615148711622, 68.96313552856445, 84.284342824451954, 91.756439873190487, 96.89460577277417, 101.68959358670064, 104.97200791249855, 102.04555419921873, 99.798798758370523, 92.940431671142576, 72.448751102570554, 44.963063940015886, 48.946539189791238, 51.072719244501386, 45.503699073983192)
s6=c(42.04889868164063, 46.306545639038092, 64.619988579429673, 81.696515564524816, 90.023514478092551, 95.340109830656687, 101.20544146024265, 105.46688654972958, 106.76682312011721, 103.65607060023719, 106.23928483913747, 105.13473472595217, 103.84116367605282, 101.27243696670959, 101.17339548701129, 101.15265499519903, 78.349167362336203, 104.38767923494666, 45.269750879936922, 99.371134526678858, 45.955920410156253)
s7=c(40.432372283935543, 44.385119384765623, 46.902128219604492, 44.040917308910473, 62.469666701096756, 77.384660812904102, 85.390882182571133, 89.821538085937505, 95.758995018935792, 101.19736412311423, 102.30571746826172, 101.41256247218652, 99.140292114257818, 75.7767443068484, 46.138437652587889, 41.959753417968749, 39.32994208901615, 42.003667340959815)
L = list(l1,l2,l3,l4,l5,l6,l7,s1,s2,s3,s4,s5,s6,s7)
lapply(L, length)



g1=c(40.432372283935543, 44.385119384765623, 46.902128219604492, 44.040917308910473,42.04889868164063, 46.306545639038092,44.924286295572912,42.79119723233309, 46.798845214843745,40.70830925835503, 44.507823110021143,42.968871236165363,44.32246242357337)
g2=c(49.445373849307792,52.590971361243206, 51.937694742838538,51.584104959239127, 52.13919292249178, 52.499807883522728, 50.019110064839211, 49.09418786390772, 50.40245239257812,50.135615148711622,62.303596097506002, 49.696831787109375)
g3=c(62.469666701096756, 64.619988579429673, 65.941206542968743, 65.642363141169298, 62.347552185058589, 63.710984799283224, 68.96313552856445, 68.375718237506447, 69.939347599362861,69.060074715102004, 68.814025065104161)
g4=c(73.392483656799897,76.432855834960932,79.024743223248095, 74.921157806396479, 76.659472270764795, 77.384660812904102)
g5=c(82.608054251163566, 83.742807617187495, 81.277307080078131, 86.133974066840267, 85.245070214586079, 83.249503417968754, 87.820906073099579, 83.949632812499999, 84.52003234863281, 84.284342824451954, 81.696515564524816, 85.390882182571133)
g6=c(89.996370771215595, 87.756848339843742,87.879115717961241, 87.73612984793526, 91.726116800436358,  89.518263640749495, 90.138806570870528, 88.512145046657977, 88.004326818129584, 92.93899471768465, 92.601106651569225, 88.937025146484373, 89.497586263020835, 92.737882401315787, 91.756439873190487, 90.023514478092551, 89.821538085937505)
g7=c(96.346493571888317, 95.215595486688272, 96.841143002219027, 94.908804087697717, 95.547263239879769, 96.074988671874991, 96.431869883080054, 97.782098764272831, 97.97407114664712, 94.167403564453124, 97.884266967773442,96.89460577277417,95.340109830656687,95.758995018935792)
g8=c(100.17752854410806, 101.8026884909237, 100.56907764499471, 102.70080517301479, 100.63172021484374, 102.42528293839419, 100.42387791367828, 98.856635655966826, 101.57182631272536, 99.041539672851556, 101.68959358670064, 101.20544146024265,101.19736412311423, 101.32896631447665)
g9=c(103.43851367147833, 107.20973825713733, 110.81886901855468, 111.24157719343368, 106.25096137152778, 106.06765684964363, 109.42897156362064, 105.99176826056532, 106.84893863351004,  104.05472696940103, 106.20833623046873, 109.89985697996681, 111.28496164270996, 109.49638957551836, 108.18452701344209, 109.75043060302735, 108.6797787661345, 106.59712971548016, 105.46688654972958, 106.76682312011721, 103.65607060023719, 106.23928483913747, 105.13473472595217)
g10=c(98.76813487510509, 101.06739334106445, 104.25301991429822, 104.66104502129878, 101.28098656631096, 102.48080788889239, 103.95732982622017, 101.46996821138048, 104.55548761157701, 102.92304807330491, 101.68035954173017, 98.866351941167082, 100.117099609375, 99.461512354800576, 98.287337456597214, 97.651616860741441, 97.304970735108483, 96.680111521753773, 96.073025360107422, 93.661611557006836, 101.34372985839843, 99.065755913085923, 101.16898753851233, 101.03036123422476, 99.138450965881347, 103.33223461914062, 104.97200791249855, 102.04555419921873, 99.798798758370523, 92.940431671142576, 103.84116367605282, 101.27243696670959, 101.17339548701129, 101.15265499519903, 102.30571746826172, 101.41256247218652, 99.140292114257818)
g11=c(72.604481087618097, 81.044985033369741, 76.340219985826877, 76.357667759486603, 78.039875634765622, 82.959180786132819, 98.433903755519694, 88.102709460890424, 53.067910754394532, 56.1603376412899, 50.391929652897389, 70.625439943188297, 65.821523104580962, 82.018099365234377, 72.448751102570554, 78.349167362336203, 104.38767923494666, 75.7767443068484)
g12=c(43.153485542831909, 47.228136474609371, 48.747833161157025, 43.325699478952508, 48.052823460355725, 45.012594517299107, 48.457507921006943, 48.152248815777661, 45.206101812318316, 47.256302166374361, 42.926473515828448, 48.857286849576901, 46.474195919552365,  48.9732700700431, 46.251836125300478, 45.112191372575431, 47.380227172851562, 44.849465332031244, 49.124373046874993, 46.982028579711908, 48.616388697130922,44.963063940015886, 48.946539189791238,45.269750879936922)
g13=c(50.681234148052376, 52.817278446320564, 50.381694889658505, 52.298518187342786, 50.353871856689459, 49.293395973276866, 97.620469923753006, 51.854613359823993, 48.72268246270913, 56.725924987792965,51.42019841974431, 51.25940431123621, 51.072719244501386, 99.371134526678858, 46.138437652587889)
g14=c(47.158087209271677, 46.729587817548897, 44.561854633318625, 44.561854633318625,44.080633680555557,41.812130353418411, 39.873726303145858, 38.546448883952664,44.475487296811984, 42.142153834292756, 47.000046615600581,44.404677246093748,45.503699073983192,45.955920410156253,41.959753417968749, 39.32994208901615, 42.003667340959815)
L=list(g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14)


source("~/searchPaths/bitbucket/squiggler/example_dtw/parse_input_events_functions.R")

lead_hmm(L, data = l1)
lead_hmm(L, data = c(l1, 69,70,64,75))
lead_hmm(L, s1)
lead_hmm(L, c(s1, 69,70,64,75))
lead_hmm(L, c(s1, 55,51,59,62))
lead_hmm(L, c(s1, 47,51,59,62))
lead_hmm(L, c(s1, rpois(n = 50, lambda = 62)))
lead_hmm(L,s2)
lead_hmm(L,c(s2, rpois(n = 50, lambda = 62)))
d<-l7
lead_hmm(L,c(d, rpois(n = 10, lambda = 62))); length(d)

### Note -- it seems like the profile hmm for run 001 is different than later runs
##
lead_hmm(L,c(190.81966696437399, 187.90008626302082, 190.01352647261186, 86.314971923828125, 190.09027862548825, 168.20036702473956, 191.03996771709734, 89.888377441406249, 92.153096863793536, 105.20679675292969, 105.17598289695945, 104.00427261226432, 103.03759129678048, 101.25763382484172, 97.441538085937495, 99.294821777343742, 100.52503701121536, 78.411425287774264, 47.555602722167961, 50.231401171875, 52.629086295984962, 48.337476279518818, rpois(n = 50, lambda = 62)))




### HAIR PIN PROFILE - max31
l1=c(66.158241869055701, 62.243102322048614, 58.656609592220178, 57.1783199842437, 70.77982645670572, 100.29852151499328, 123.47322377472675, 129.76626403808595, 110.33153889973957, 56.96401758829753, 47.020195896474561, 47.536156372923955, 46.816061323280429, 46.907960586547844, 45.953837832496284, 46.560520554001272, 45.435220301011029, 46.938543456346423, 46.468505504052963, 46.730685253425186, 47.970399676067068, 47.065632857771114, 46.620575853837401, 45.442259023813101, 48.872249058314729, 62.036788035425644, 67.237087213575222, 70.769486582880432, 70.428681740956762, 76.126857853379363)
l2=c(69.941618652343749, 67.718833697013295, 61.364608561197919, 56.799485657707088, 70.137697358972872, 99.161932576497392, 120.59478560353053, 125.10305627893518, 109.81249595528217, 63.484381245457847, 46.97980486012468, 45.1288427474651, 46.615050863125525, 48.514198106695851, 62.459679283267157, 66.657685831004173, 69.235364849384013, 70.17024084242334, 75.513130992542614)
l3=c(63.467359422253033, 70.584894409179682, 74.354514353464069, 71.999285079601194, 61.940231430951293, 102.85814409304886, 108.78670242309569, 103.07503622731855, 104.54422299985531, 123.57926435786523, 128.20344676050647, 113.73188480377196, 92.982586669921872, 51.462140219373985, 53.436206448815859, 67.118871557412021, 71.213332054935279, 74.882260002367417, 79.407250008418643, 71.056386299133294)

s1=c(64.348412170410157, 66.817429088245746, 62.829951028262862, 54.748621049360793, 62.960165405273429, 97.273369750976556, 112.33164294433594, 103.44664348098466, 62.753639346852012, 44.32685353246228, 43.606539378086453, 43.78506983263739, 43.807955709706178, 43.65661553440323, 45.06628741096047, 57.369426269531246, 62.397179003906238, 64.129793334960937, 69.810187049278852, 65.600823717619249)
s2=c(68.126989672557414, 66.318059444942975, 55.704792244203624, 60.016439541903409, 66.942487076469078, 84.540624389648428, 94.787215795023016, 114.80032583797677, 117.82765869140624, 107.18157348632812, 104.77688069661457, 99.539638264973945, 58.064201733398434, 45.022766491375137, 45.254549388885501, 44.784871350740133, 45.017990595703125, 44.918963470458984, 44.922508798275352, 44.943222390286749, 45.001783214368317, 44.944771858147817, 47.035516406249997, 60.276847209524597, 65.686551635742177, 67.978445800781245, 67.878231201171872, 68.448880337801839)
s3=c(65.614194057955601, 65.618287077130006, 63.120182723999015, 53.470323303222656, 64.326925874092211, 89.73405826344208, 110.93718450881141, 104.21992318725586, 63.396030273437496, 61.145037554572603, 44.226511711909851, 43.405448455810543, 52.815534532335064, 61.506032090297964, 48.333070615571117, 46.20559831891741, 49.003513606144828)
s4=c(70.604007297092011, 67.651718749999986, 57.407714595794673, 68.664572607421874, 69.567636566162108, 91.323413899739577, 102.61014038085936, 66.28625891397165, 48.627270045924831, 48.025173675817079, 48.044111000877677, 47.833355610597067, 48.341287144252234, 47.883802214591725, 62.55956272499234, 62.572134132385251, 64.220073177939966, 62.460398392128724, 62.082609238735465)
s5=c(46.854479851973679, 50.866917317708328, 61.881477675327034, 72.003615942783028, 78.190267740885417, 80.81009370246818, 81.622521577314899, 83.698961379874461, 83.315397949218749, 84.056995453933183, 83.55946043534712, 84.187127685546869, 44.562519717009167, 50.118867827728906, 59.18444308471679, 53.936990432739258, 61.746170987215905, 52.628680826822908, 62.090523178257889, 86.877821044921873, 107.66017449057026, 112.6089310334858, 102.56179384977919, 101.6894528602692, 60.760610287314961, 45.026556884765625, 42.981877612133957, 42.844163926068468, 43.076382221422698)
s6=c(51.800215176669028, 64.17715502929687, 70.251003537061735, 73.357430114746094, 55.042525634765624, 84.100183512369782, 105.17127548217773, 117.23543159179687, 124.89072875976562, 119.97993881835937, 97.144240493774419, 67.992860229492194, 52.73078303019205, 42.286663363956663, 42.082279617962669, 42.871545602898841, 42.192696040226856, 42.23458880045925, 41.920550321691167, 42.433332519531241, 42.334767881567913, 42.438480529785153, 42.275205982349533, 41.150708723397088, 42.807421264648433, 43.436710518078925, 55.527154364764364, 61.948779390775236, 64.017360791015619, 69.362230957031258, 70.84691711425782)
s7=c(49.950574444621594, 66.153352803981051, 76.365105250071892, 81.087612343542759, 84.532378212397902, 84.937523554891655, 86.000715298122827, 46.367686450302863, 46.777101957775294, 53.819468436262724, 62.413480864025288, 56.629866932362049, 65.984912923177077, 68.079389121859677, 55.0000537109375, 68.977340087890624, 73.636435546874992, 72.103100716145832, 101.03046158017848, 96.675909161261785, 116.74069050114329, 121.63760015769083, 107.6471639476103, 63.541005840738308, 53.937946463103337, 43.913835988011847, 44.228422490380673, 44.075661613627673)
s8=c(68.032363088507395, 66.552013044084816, 76.22734716796873, 77.415576766576521, 68.765664301853548, 109.34451237605168, 129.74444488525393, 129.65196413730055, 131.34582204718339, 121.17269575517254, 76.449917918238143, 55.214107560797352, 55.413723179659392, 53.806870727539057, 57.419842170266548, 57.461720956089984, 66.184275159333865, 72.117675044952875, 76.391228290095995, 79.560039010555187, 84.419681659001171)
s9=c(77.004737204527245, 73.911648883819595, 84.248745375689339, 96.118974984975964, 91.312589172363289, 103.738345820986, 128.74940953615334, 138.50199054328763, 128.11092056274413, 80.468828582763678, 59.044383537757476, 59.778439200481962, 59.499845700843309, 59.426917538174713, 61.485647627667674, 76.204213221646683, 79.85853093732868, 83.142617669753093, 83.250442049541178, 88.120102003666403)
s10=c(60.906900163405005, 69.418249609374996, 74.043959455818964, 59.600058203124995, 76.309883133737671, 119.77973129734848, 54.584843515249396, 49.930329463930633, 51.852153757579288, 65.13474374276619, 70.374265235361435, 78.707571658068943, 70.210295837402342, 62.900189466879397)




# g1=c(66.158241869055701, 62.243102322048614, 58.656609592220178, 57.1783199842437, 70.77982645670572, 69.941618652343749, 67.718833697013295, 61.364608561197919, 56.799485657707088, 70.137697358972872, 63.467359422253033, 70.584894409179682, 74.354514353464069, 71.999285079601194, 61.940231430951293, 64.348412170410157, 66.817429088245746, 62.829951028262862, 54.748621049360793, 62.960165405273429, 68.126989672557414, 66.318059444942975, 55.704792244203624, 60.016439541903409, 66.942487076469078, 65.614194057955601, 65.618287077130006, 63.120182723999015, 53.470323303222656, 64.326925874092211, 70.604007297092011, 67.651718749999986, 57.407714595794673, 68.664572607421874, 69.567636566162108, 51.800215176669028, 64.17715502929687, 70.251003537061735, 73.357430114746094, 55.042525634765624, 68.032363088507395, 66.552013044084816, 76.22734716796873, 77.415576766576521, 68.765664301853548, 60.906900163405005, 69.418249609374996, 74.043959455818964, 59.600058203124995, 76.309883133737671)
g2=c(100.29852151499328,99.161932576497392, 102.85814409304886, 97.273369750976556, 84.540624389648428, 94.787215795023016, 89.73405826344208, 91.323413899739577, 84.100183512369782)
g3=c(112.33164294433594, 114.80032583797677, 117.82765869140624, 107.18157348632812, 110.93718450881141, 105.17127548217773, 117.23543159179687, 124.89072875976562, 119.97993881835937, 109.34451237605168, 129.74444488525393, 129.65196413730055, 131.34582204718339, 121.17269575517254, 123.47322377472675, 129.76626403808595, 110.33153889973957, 119.77973129734848, 120.59478560353053, 125.10305627893518, 109.81249595528217, 108.78670242309569, 103.07503622731855, 104.54422299985531, 123.57926435786523, 128.20344676050647, 113.73188480377196)
g4=c(92.982586669921872, 103.44664348098466, 104.77688069661457, 99.539638264973945, 104.21992318725586, 102.61014038085936, 97.144240493774419)
g5=c(56.96401758829753,63.484381245457847, 62.753639346852012, 58.064201733398434, 63.396030273437496, 61.145037554572603, 66.28625891397165, 67.992860229492194, 52.73078303019205, 76.449917918238143, 55.214107560797352, 55.413723179659392, 53.806870727539057, 57.419842170266548, 57.461720956089984,  54.584843515249396)
g6=c(47.020195896474561, 47.536156372923955, 46.816061323280429, 46.907960586547844, 45.953837832496284, 46.560520554001272, 45.435220301011029, 46.938543456346423, 46.468505504052963, 46.730685253425186, 47.970399676067068, 47.065632857771114, 46.620575853837401, 45.442259023813101, 48.872249058314729, 46.97980486012468, 45.1288427474651, 46.615050863125525, 48.514198106695851, 44.32685353246228, 43.606539378086453, 43.78506983263739, 43.807955709706178, 43.65661553440323, 45.06628741096047, 49.930329463930633, 51.852153757579288)
L=list(g2,g3,g4,g5,g6)
sapply(L,mean)
sapply(L,sd)

source("~/searchPaths/bitbucket/squiggler/example_dtw/parse_input_events_functions.R")
hp_hmm(L, s4)
hp_hmm(L, c(rpois(n = 10, lambda = 65), s4, rpois(n = 10, lambda = 65)))
d=c(50.529602050781243, 43.425961026278401, 43.021920437282986, 52.195322265624995, 55.869826660156249, 56.680158812610806, 52.724719898120782, 54.317384719848626, 45.852682362432063, 50.11345381303267, 54.850491098257208, 60.571456298828117, 47.819993760850693, 45.624751790364577, 41.218825378417968, 47.024976318359371, 53.252988009982637, 55.732394409179683, 52.797750854492186, 50.198937988281244, 57.49341900165264, 60.645542584043554, 58.520650227864579, 49.351288414001459, 59.060734863281247, 85.689460563659665, 84.635623301630432, 104.98462416704963, 112.39064819335937, 111.60945434570311, 101.29990808823528, 62.77037231445312, 41.674387839988427, 40.094325584701345, 39.865737636913813, 39.746472938939142, 38.778398301866318, 39.938672802116294, 38.944379281306603, 40.183950195312498, 38.947905384410511, 39.917100264386427, 41.099476318359372, 40.136894155649038, 51.721773512819979, 56.323111979166669, 52.216641395970392, 51.579836203835221, 41.819910644531248, 51.917119328425478, 57.142883300781243, 58.842703247070311, 52.368920898437494, 58.719737548828121, 52.436185761469943, 59.696034364442568, 65.737157721268503, 65.788370768229157, 64.512788221571185, 65.746740827889269, 64.861214671415439, 65.533483886718741, 59.948259899662986, 53.667466227213538, 58.861850155101095, 56.280454195462738, 55.50587864925987, 56.549754638671871, 58.722857785692398)
hp_hmm(L,d)
hp_hmm(L,rpois(69,65))

